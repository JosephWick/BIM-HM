function [s12]=computeStressVerticalShearZone_s12( ...
    x1,x2,x3,q1,q2,q3,L,T,W,theta,epsv11p,epsv12p,epsv13p,epsv22p,epsv23p,epsv33p,G,nu)
% function COMPUTESTRESSVERTICALSHEARZONE computes the stress field
% associated with deforming vertical shear zones using the analytic
% solution considering the following geometry.
%
%                      N (x1)
%                     /
%                    /| strike (theta)          E (x2)
%        q1,q2,q3 ->@--------------------------+
%                   |                        w |     +
%                   |                        i |    /
%                   |                        d |   / s
%                   |                        t |  / s
%                   |                        h | / e
%                   |                          |/ n
%                   +--------------------------+  k
%                   :       l e n g t h       /  c
%                   |                        /  i
%                   :                       /  h
%                   |                      /  t
%                   :                     /
%                   |                    +
%                   Z (x3)
%
%
% Input:
% x1, x2, x3         northing, easting, and depth of the observation point,
% q1, q2, q3         north, east and depth coordinates of the shear zone,
% L, T, W            length, thickness, and width of the shear zone,
% theta (degree)     strike of the shear zone,
% epsvijp            source strain component 11, 12, 13, 22, 23 and 33
%                    in the shear zone in the system of reference tied to
%                    the shear zone (primed reference system),
% G, nu              shear modulus and Poisson's ratio in the half space.
%
% Output:
% sij                stress components in the umprimed reference system.
%
% Author: Sylvain Barbot (sbarbot@usc.edu) - 11 July 2016.

% Lame parameter
lambda = G*2*nu/(1-2*nu);

% isotropic strain
epsvkk=epsv11p+epsv22p+epsv33p;

% rotate observation points to the shear-zone-centric system of coordinates
t1= (x1-q1)*cosd(theta)+(x2-q2)*sind(theta);
x2=-(x1-q1)*sind(theta)+(x2-q2)*cosd(theta);
x1=t1;

% Green's functions

r1=@(y1,y2,y3) sqrt((x1-y1).^2+(x2-y2).^2+(x3-y3).^2);
r2=@(y1,y2,y3) sqrt((x1-y1).^2+(x2-y2).^2+(x3+y3).^2);
disp(r1)
disp(r2)

IU1d2=@(y1,y2,y3) ...
     (lambda*epsvkk+2*G*epsv11p)*J1123d2(y1,y2,y3) ...
                   +2*G*epsv12p*(J1223d2(y1,y2,y3)+J1113d2(y1,y2,y3)) ...
                   +2*G*epsv13p*(J1323d2(y1,y2,y3)+J1112d2(y1,y2,y3)) ...
    +(lambda*epsvkk+2*G*epsv22p)*J1213d2(y1,y2,y3) ...
                   +2*G*epsv23p*(J1212d2(y1,y2,y3)+J1313d2(y1,y2,y3)) ...
    +(lambda*epsvkk+2*G*epsv33p)*J1312d2(y1,y2,y3);

IU2d1=@(y1,y2,y3) ...
     (lambda*epsvkk+2*G*epsv11p)*J2123d1(y1,y2,y3) ...
                   +2*G*epsv12p*(J2223d1(y1,y2,y3)+J2113d1(y1,y2,y3)) ...
                   +2*G*epsv13p*(J2323d1(y1,y2,y3)+J2112d1(y1,y2,y3)) ...
    +(lambda*epsvkk+2*G*epsv22p)*J2213d1(y1,y2,y3) ...
                   +2*G*epsv23p*(J2212d1(y1,y2,y3)+J2313d1(y1,y2,y3)) ...
    +(lambda*epsvkk+2*G*epsv33p)*J2312d1(y1,y2,y3);


% displacement gradient

u12 = IU1d2(L,T/2,q3+W)-IU1d2(L,-T/2,q3+W)+IU1d2(L,-T/2,q3)-IU1d2(L,T/2,q3) ...
     -IU1d2(0,T/2,q3+W)+IU1d2(0,-T/2,q3+W)-IU1d2(0,-T/2,q3)+IU1d2(0,T/2,q3);
u21 = IU2d1(L,T/2,q3+W)-IU2d1(L,-T/2,q3+W)+IU2d1(L,-T/2,q3)-IU2d1(L,T/2,q3) ...
     -IU2d1(0,T/2,q3+W)+IU2d1(0,-T/2,q3+W)-IU2d1(0,-T/2,q3)+IU2d1(0,T/2,q3);

% strain
e12p=(u12+u21)/2;

% rotate stress field to reference (unprimed) system of coordinates
e12=e12p;

% remove inelastic eigenstrain
Omega=@(x) heaviside(x+0.5)-heaviside(x-0.5);
S=@(x) Omega(x-0.5);

epsv12=epsv12p;

e12=e12-epsv12*S(x1/L).*Omega(x2/T).*S((x3-q3)/W);

% stress components
s12=2*G*e12;

    function y=heaviside(x)
        y=x>0;
    end

    function y=xLogy(x,y)
        y=x.*log(y);
        y(0==x)=0;
    end


    function d=J1112d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*((-4).*((-1)+nu).* ...
            lr1.^(-1).*(lr1+x1-y1).^(-1).*(x2-y2).^2-4.*((-1)+nu) ...
            .*lr2.^(-1).*(lr2+x1-y1).^(-1).*(x2-y2).^2-((-3)+ ...
            4.*nu).*(x1-y1).*(lr1+x2-y2).^(-1)-((-3)+4.*nu).* ...
            lr1.^(-1).*(x1-y1).*(x2-y2).*(lr1+x2-y2).^(-1)+(5+ ...
            4.*nu.*((-3)+2.*nu)).*(x1-y1).*(lr2+x2-y2).^(-1)+(5+4.* ...
            nu.*((-3)+2.*nu)).*lr2.^(-1).*(x1-y1).*(x2-y2).*(lr2+x2+ ...
            (-1).*y2).^(-1)+4.*((-1)+nu).*lr1.*(x1-y1).*((x1-y1) ...
            .^2+(x3-y3).^2).^(-1).*((x2-y2).^2+(x3-y3).^2) ...
            .^(-1).*(x3-y3).^2-4.*((-1)+nu).*lr1.^(-1).*(x1-y1) ...
            .*(x2-y2).^2.*((x1-y1).^2+(x3-y3).^2).^(-1).*(( ...
            x2-y2).^2+(x3-y3).^2).^(-1).*(x3-y3).^2-4.*(( ...
            -1)+nu).*((-1)+2.*nu).*(x1-y1).*((x1-y1).^2+(x2- ...
            y2).^2).^(-1).*(x3+y3)+2.*lr2.^(-1).*x3.*(x1-y1).*y3.*((x1+( ...
            -1).*y1).^2+(x3+y3).^2).^(-1)+4.*((-1)+nu).*((-1)+2.*nu).*lr2.*(x1+ ...
            (-1).*y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x3+y3).^2.* ...
            ((x1-y1).^2+(x3+y3).^2).^(-1)-4.*((-1)+nu).*((-1)+2.*nu) ...
            .*lr2.^(-1).*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^( ...
            -1).*(x2-y2).^2.*(x3+y3).^2.*((x1-y1).^2+(x3+y3).^2) ...
            .^(-1)+4.*((-1)+nu).*lr2.*(x1-y1).*(x3+y3).^2.*((x1-y1) ...
            .^2+(x3+y3).^2).^(-1).*((x2-y2).^2+(x3+y3).^2).^(-1)-4.*( ...
            (-1)+nu).*lr2.^(-1).*(x1-y1).*(x2-y2).^2.*(x3+y3).^2.*( ...
            (x1-y1).^2+(x3+y3).^2).^(-1).*((x2-y2).^2+(x3+y3).^2) ...
            .^(-1)-2.*x3.*(x1-y1).*(x2-y2).^2.*y3.*((x1- ...
            y1).^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2).^(-3/2)+xLogy(4-4.*nu,lr1+x1-y1)+xLogy(4-4.*nu, ...
            lr2+x1-y1));
    end



    function d=J1113d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(x2.*(x2.^2+(x1+( ...
            -1).*y1).^2).^(-1).*(-x1+y1)+9.*x2.*(9.*x2.^2+(x1-y1) ...
            .^2).^(-1).*(-x1+y1)+4.*nu.^2.*x2.*(nu.^2.*x2.^2+(x1- ...
            y1).^2).^(-1).*(-x1+y1)-4.*((-1)+nu).*lr1.^(-1).*(lr1+x1+( ...
            -1).*y1).^(-1).*(x2-y2).*(x3-y3)-4.*((-1)+nu).*lr1.* ...
            (x1-y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2+(-1) ...
            .*y2).*((x2-y2).^2+(x3-y3).^2).^(-1).*(x3-y3)+( ...
            -4).*((-1)+nu).*lr1.^(-1).*(x1-y1).*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-1).*(x2-y2).^3.*((x2-y2).^2+(x3- ...
            y3).^2).^(-1).*(x3-y3)-((-3)+4.*nu).*lr1.^(-1).*(x1+( ...
            -1).*y1).*(x2-y2).*(lr1+x3-y3).^(-1)+4.*((-1)+nu).* ...
            lr2.^(-1).*(lr2+x1-y1).^(-1).*(x2-y2).*(x3+y3)-(3+ ...
            (-6).*nu+4.*nu.^2).*lr2.^(-1).*(x1-y1).*(x2-y2).*(lr2+ ...
            x3+y3).^(-1)-4.*((-1)+nu).*((-1)+2.*nu).*(x1-y1).*((x1+( ...
            -1).*y1).^2+(x2-y2).^2).^(-2).*(x2-y2).*y3.*(2.*x3+y3) ...
            +2.*((-1)+nu).*((-1)+2.*nu).*lr2.^(-2).*(x1-y1).*((x1- ...
            y1).^2+(x2-y2).^2).^(-1).*(x2-y2).*y3.*(2.*x3+y3) ...
            -4.*lr2.^(-1).*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^( ...
            -1).*(x2-y2).*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3))+4.*(( ...
            -1)+nu).*lr2.*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^( ...
            -1).*(x2-y2).*(x3+y3).*((x2-y2).^2+(x3+y3).^2).^(-1)+ ...
            4.*((-1)+nu).*lr2.^(-1).*(x1-y1).*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-1).*(x2-y2).^3.*(x3+y3).*((x2-y2).^2+(x3+ ...
            y3).^2).^(-1)+2.*(x1-y1).*((x1-y1).^2+(x2-y2) ...
            .^2).^(-1).*(x2-y2).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2).^(-3/2).*((-3).*nu.*(x3.*(x3.^2+(x1-y1).^2+(x2+(-1) ...
            .*y2).^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1).^2+(x2-y2).^2) ...
            .*y3-(lr2-3.*x3).*y3.^2+y3.^3)+2.*nu.^2.*(x3.*(x3.^2+(x1+( ...
            -1).*y1).^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1) ...
            .^2+(x2-y2).^2).*y3-(lr2-3.*x3).*y3.^2+y3.^3)+y3.*(( ...
            x1-y1).^2+(x2-y2).^2-(lr2-x3-y3).*( ...
            2.*x3+y3)))+4.*lr2.^(-1).*(x1-y1).*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-2).*(x2-y2).*((-3).*nu.*(x3+y3).*((x1-y1) ...
            .^2+(x2-y2).^2+(x3+y3).^2)+2.*nu.^2.*(x3+y3).*((x1-y1) ...
            .^2+(x2-y2).^2+(x3+y3).^2)+y3.*((x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).*(2.*x3+y3)))+atan2(x1-y1,(-1).*x2)-3.* ...
            atan2(3.*x2,x1-y1)+4.*nu.*atan2(-nu.*x2,x1-y1)+( ...
            4-4.*nu).*atan2(lr1.*(x2-y2),(x1-y1).*(x3-y3)) ...
            +4.*((-1)+nu).*atan2(lr2.*(x2-y2),(x1-y1).*(x3+y3)));
    end



    function d=J1123d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(x1.^2.*(x1.^2+(x2+ ...
            (-1).*y2).^2).^(-1)+9.*x1.^2.*(9.*x1.^2+(x2-y2).^2).^(-1)+ ...
            4.*nu.^2.*x1.^2.*(nu.^2.*x1.^2+(x2-y2).^2).^(-1)-2.*((-1) ...
            +nu).*((-1)+2.*nu).*(x1-y1).^2.*((x1-y1).^2+(x2- ...
            y2).^2).^(-1)+y1.^2.*(y1.^2+(x2-y2).^2).^(-1)+9.*y1.^2.*(9.* ...
            y1.^2+(x2-y2).^2).^(-1)+4.*nu.^2.*y1.^2.*(nu.^2.*y1.^2+(x2+( ...
            -1).*y2).^2).^(-1)+2.*x3.*(lr2-x2+y2).^(-1)+2.*lr2.^(-1).*x3.* ...
            (-x2+y2).*(lr2-x2+y2).^(-1)-((-3)+4.*nu).*(lr1+x2+( ...
            -1).*y2).^(-1).*(x3-y3)-((-3)+4.*nu).*lr1.^(-1).*(x2+( ...
            -1).*y2).*(lr1+x2-y2).^(-1).*(x3-y3)+2.*((-1)+2.*nu).* ...
            lr1.*(x1-y1).^2.*((x1-y1).^2+(x2-y2).^2).^(-1).*( ...
            (x1-y1).^2+(x3-y3).^2).^(-1).*(x3-y3)-2.*(( ...
            -1)+2.*nu).*lr1.^(-1).*(x1-y1).^2.*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-1).*(x2-y2).^2.*((x1-y1).^2+(x3-y3) ...
            .^2).^(-1).*(x3-y3)-((-3)+4.*nu).*lr1.^(-1).*(x2- ...
            y2).^2.*(lr1+x3-y3).^(-1)-(5+4.*nu.*((-3)+2.*nu)).*(lr2+ ...
            x2-y2).^(-1).*(x3+y3)-(5+4.*nu.*((-3)+2.*nu)).*lr2.^( ...
            -1).*(x2-y2).*(lr2+x2-y2).^(-1).*(x3+y3)-(3 ...
            -6.*nu+4.*nu.^2).*lr2.^(-1).*(x2-y2).^2.*(lr2+x3+y3).^(-1)+4.*(( ...
            -1)+nu).*((-1)+2.*nu).*((x1-y1).^2+(x2-y2).^2).^(-2).* ...
            (x2-y2).^2.*y3.*(2.*x3+y3)-2.*((-1)+nu).*((-1)+2.*nu).* ...
            lr2.^(-2).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2) ...
            .^2.*y3.*(2.*x3+y3)+2.*((-1)+2.*nu).*((x1-y1).^2+(x2- ...
            y2).^2).^(-1).*((x1-y1).^2+(x3+y3).^2).^(-1).*(((-1)+2.*nu) ...
            .*lr2.*(x1-y1).^2.*(x3+y3)-((-1)+nu).*y3.*(2.*x3+y3).*( ...
            (x1-y1).^2+(x3+y3).^2))-4.*lr2.^(-1).*((x1-y1).^2+( ...
            x2-y2).^2).^(-2).*(x2-y2).^2.*((x1-y1).^2+(x3+ ...
            y3).^2).^(-1).*(x1.^4.*y3-4.*x1.^3.*y1.*y3-3.*nu.*(x3+y3).*( ...
            (x1-y1).^2+(x3+y3).^2).*((x1-y1).^2+(x2-y2).^2+( ...
            x3+y3).^2)+2.*nu.^2.*(x3+y3).*((x1-y1).^2+(x3+y3).^2).*((x1+ ...
            (-1).*y1).^2+(x2-y2).^2+(x3+y3).^2)-2.*x1.*y1.*y3.*((x2+( ...
            -1).*y2).^2+2.*(y1.^2+(x3+y3).*(2.*x3+y3)))+y3.*(2.*x3.^4+7.* ...
            x3.^3.*y3+(y1.^2+y3.^2).*(y1.^2+y2.^2+y3.^2)+x3.*y3.*(6.*y1.^2+3.* ...
            y2.^2+5.*y3.^2)+x3.^2.*(4.*y1.^2+2.*y2.^2+9.*y3.^2)+x2.^2.*(y1.^2+ ...
            (x3+y3).*(2.*x3+y3))-2.*x2.*y2.*(y1.^2+(x3+y3).*(2.*x3+y3)))+ ...
            x1.^2.*y3.*((x2-y2).^2+2.*(3.*y1.^2+(x3+y3).*(2.*x3+y3))))+( ...
            -2).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2).^2.* ...
            ((x1-y1).^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).^2).^(-3/2).*(x1.^4.*(y3-3.*nu.*(x3+y3)+2.* ...
            nu.^2.*(x3+y3))-4.*x1.^3.*y1.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*( ...
            x3+y3))-3.*nu.*(y1.^2+(x3+y3).^2).*(x3.^3+3.*x3.^2.*y3+y3.*( ...
            y1.^2+y2.^2-lr2.*y3+y3.^2)+x3.*(y1.^2+y2.^2-2.*lr2.*y3+3.* ...
            y3.^2))+2.*nu.^2.*(y1.^2+(x3+y3).^2).*(x3.^3+3.*x3.^2.*y3+y3.*( ...
            y1.^2+y2.^2-lr2.*y3+y3.^2)+x3.*(y1.^2+y2.^2-2.*lr2.*y3+3.* ...
            y3.^2))+y3.*(2.*x3.^4+7.*x3.^3.*y3+(y1.^2+y3.^2).*(y1.^2+y2.^2+ ...
            y3.^2)+x3.*y3.*(6.*y1.^2+3.*y2.^2+5.*y3.^2)+x3.^2.*(4.*y1.^2+2.* ...
            y2.^2+9.*y3.^2)-lr2.*(2.*x3+y3).*(y1.^2+(x3+y3).^2))+2.*x2.* ...
            y2.*(3.*nu.*(x3+y3).*(y1.^2+(x3+y3).^2)-2.*nu.^2.*(x3+y3).*( ...
            y1.^2+(x3+y3).^2)-y3.*(y1.^2+(x3+y3).*(2.*x3+y3)))+x2.^2.*(( ...
            -3).*nu.*(x3+y3).*(y1.^2+(x3+y3).^2)+2.*nu.^2.*(x3+y3).*(y1.^2+( ...
            x3+y3).^2)+y3.*(y1.^2+(x3+y3).*(2.*x3+y3)))+2.*x1.*y1.*(((-1)+nu) ...
            .*((-1)+2.*nu).*lr2.*y3.*(2.*x3+y3)+x2.^2.*(-y3+3.*nu.*(x3+y3) ...
            -2.*nu.^2.*(x3+y3))+2.*x2.*y2.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.* ...
            (x3+y3))+3.*nu.*(x3+y3).*(2.*y1.^2+y2.^2+2.*(x3+y3).^2)-2.* ...
            nu.^2.*(x3+y3).*(2.*y1.^2+y2.^2+2.*(x3+y3).^2)-y3.*(2.* ...
            y1.^2+y2.^2+2.*(x3+y3).*(2.*x3+y3)))+x1.^2.*(-((-1)+nu).*(( ...
            -1)+2.*nu).*lr2.*y3.*(2.*x3+y3)+2.*x2.*y2.*(-y3+3.*nu.*(x3+y3) ...
            -2.*nu.^2.*(x3+y3))+x2.^2.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+ ...
            y3))-3.*nu.*(x3+y3).*(6.*y1.^2+y2.^2+2.*(x3+y3).^2)+2.*nu.^2.*( ...
            x3+y3).*(6.*y1.^2+y2.^2+2.*(x3+y3).^2)+y3.*(6.*y1.^2+y2.^2+2.*(x3+ ...
            y3).*(2.*x3+y3))))+2.*lr2.^(-1).*((x1-y1).^2+(x2-y2) ...
            .^2).^(-1).*((x1-y1).^2+(x3+y3).^2).^(-1).*(-x3.* ...
            y1.^2.*y2.^2+2.*x3.^4.*y3+4.*x3.^2.*y1.^2.*y3+y1.^4.*y3+6.*x3.^2.* ...
            y2.^2.*y3+2.*y1.^2.*y2.^2.*y3+7.*x3.^3.*y3.^2+6.*x3.*y1.^2.*y3.^2+ ...
            9.*x3.*y2.^2.*y3.^2+9.*x3.^2.*y3.^3+2.*y1.^2.*y3.^3+3.*y2.^2.* ...
            y3.^3+5.*x3.*y3.^4+y3.^5-nu.*(x3+y3).*(3.*x3.^4+6.*x3.^2.* ...
            y1.^2+3.*y1.^4+9.*x3.^2.*y2.^2+5.*y1.^2.*y2.^2+6.*x3.*(2.*(x3.^2+ ...
            y1.^2)+3.*y2.^2).*y3+3.*(6.*x3.^2+2.*y1.^2+3.*y2.^2).*y3.^2+12.* ...
            x3.*y3.^3+3.*y3.^4)+x1.^4.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3) ...
            )-4.*x1.^3.*y1.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3))+2.* ...
            nu.^2.*(x3+y3).*(x3.^4+y1.^4+4.*x3.^3.*y3+3.*y2.^2.*y3.^2+y3.^4+ ...
            y1.^2.*(y2.^2+2.*y3.^2)+x3.^2.*(2.*y1.^2+3.*y2.^2+6.*y3.^2)+x3.*( ...
            4.*y1.^2.*y3+6.*y2.^2.*y3+4.*y3.^3))+x2.^2.*(-x3.*y1.^2+6.* ...
            x3.^2.*y3+2.*y1.^2.*y3+9.*x3.*y3.^2+3.*y3.^3+2.*nu.^2.*(x3+y3).*( ...
            y1.^2+3.*(x3+y3).^2)-nu.*(x3+y3).*(5.*y1.^2+9.*(x3+y3).^2))+ ...
            2.*x2.*y2.*(x3.*y1.^2-6.*x3.^2.*y3-2.*y1.^2.*y3-9.*x3.* ...
            y3.^2-3.*y3.^3-2.*nu.^2.*(x3+y3).*(y1.^2+3.*(x3+y3).^2)+nu.* ...
            (x3+y3).*(5.*y1.^2+9.*(x3+y3).^2))+2.*x1.*y1.*(x2.^2.*x3-2.* ...
            x2.*x3.*y2+x3.*y2.^2-2.*x2.^2.*y3-4.*x3.^2.*y3-2.*y1.^2.* ...
            y3+4.*x2.*y2.*y3-2.*y2.^2.*y3-6.*x3.*y3.^2-2.*y3.^3 ...
            -2.*nu.^2.*(x3+y3).*((x2-y2).^2+2.*(y1.^2+(x3+y3).^2))+nu.*( ...
            x3+y3).*(5.*(x2-y2).^2+6.*(y1.^2+(x3+y3).^2)))+x1.^2.*((-1) ...
            .*x2.^2.*x3+2.*x2.*x3.*y2-x3.*y2.^2+2.*x2.^2.*y3+4.*x3.^2.* ...
            y3+6.*y1.^2.*y3-4.*x2.*y2.*y3+2.*y2.^2.*y3+6.*x3.*y3.^2+2.* ...
            y3.^3+2.*nu.^2.*(x3+y3).*((x2-y2).^2+2.*(3.*y1.^2+(x3+y3) ...
            .^2))-nu.*(x3+y3).*(5.*(x2-y2).^2+6.*(3.*y1.^2+(x3+y3) ...
            .^2))))+xLogy(3-4.*nu,lr1+x3-y3)+xLogy((-3)+6.*nu-4.* ...
            nu.^2,lr2+x3+y3));
    end


    function d=J2112d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*((1+8.*((-1)+nu).*nu).*lr2.^( ...
            -1).*(x1-y1)+lr1.^(-1).*(-x1+y1)-4.*((-1)+nu).*((-1)+ ...
            2.*nu).*lr2.^(-1).*(x1-y1).*(x3+y3).*(lr2+x3+y3).^(-1)+2.*x3.* ...
            (x1-y1).*y3.*((x1-y1).^2+(x2-y2).^2+(x3+y3).^2) ...
            .^(-3/2)).*G.^(-1);
    end


    function d=J2113d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*(-lr1.^(-1).*(x1- ...
            y1).*(x2-y2).*(lr1+x3-y3).^(-1)-((-1)-2.*nu+ ...
            4.*nu.^2).*lr2.^(-1).*(x1-y1).*(x2-y2).*(lr2+x3+y3).^( ...
            -1)-4.*((-1)+nu).*((-1)+2.*nu).*(x1-y1).*((x1-y1) ...
            .^2+(x2-y2).^2).^(-2).*(x2-y2).*y3.*(2.*x3+y3)+2.*(( ...
            -1)+nu).*((-1)+2.*nu).*lr2.^(-2).*(x1-y1).*((x1-y1).^2+ ...
            (x2-y2).^2).^(-1).*(x2-y2).*y3.*(2.*x3+y3)-4.*lr2.^( ...
            -1).*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*( ...
            x2-y2).*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3))+2.*(x1+(-1) ...
            .*y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2).*( ...
            (x1-y1).^2+(x2-y2).^2+(x3+y3).^2).^(-3/2).*((-3).*nu.* ...
            (x3.*(x3.^2+(x1-y1).^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.* ...
            x3)+(x1-y1).^2+(x2-y2).^2).*y3-(lr2-3.*x3).* ...
            y3.^2+y3.^3)+2.*nu.^2.*(x3.*(x3.^2+(x1-y1).^2+(x2-y2) ...
            .^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1).^2+(x2-y2).^2).*y3+ ...
            (-1).*(lr2-3.*x3).*y3.^2+y3.^3)+y3.*((x1-y1).^2+(x2- ...
            y2).^2-(lr2-x3-y3).*(2.*x3+y3)))+4.*lr2.^(-1).*( ...
            x1-y1).*((x1-y1).^2+(x2-y2).^2).^(-2).*(x2+(-1) ...
            .*y2).*((-3).*nu.*(x3+y3).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2)+2.*nu.^2.*(x3+y3).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2)+y3.*((x1-y1).^2+(x2-y2).^2+(x3+y3).*(2.*x3+y3) ...
            ))).*G.^(-1);
    end


    function d=J2123d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(-lr1.^(-1).*( ...
            x1-y1).^2.*(lr1+x3-y3).^(-1)-((-1)-2.*nu+4.* ...
            nu.^2).*lr2.^(-1).*(x1-y1).^2.*(lr2+x3+y3).^(-1)-4.*((-1)+ ...
            nu).*((-1)+2.*nu).*(x1-y1).^2.*((x1-y1).^2+(x2- ...
            y2).^2).^(-2).*y3.*(2.*x3+y3)+2.*((-1)+nu).*((-1)+2.*nu).*((x1+( ...
            -1).*y1).^2+(x2-y2).^2).^(-1).*y3.*(2.*x3+y3)+2.*((-1)+nu).* ...
            ((-1)+2.*nu).*lr2.^(-2).*(x1-y1).^2.*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-1).*y3.*(2.*x3+y3)+2.*(x1-y1).^2.*((x1+(-1) ...
            .*y1).^2+(x2-y2).^2).^(-1).*((x1-y1).^2+(x2-y2) ...
            .^2+(x3+y3).^2).^(-3/2).*((-3).*nu.*(x3.*(x3.^2+(x1-y1).^2+( ...
            x2-y2).^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1).^2+(x2- ...
            y2).^2).*y3-(lr2-3.*x3).*y3.^2+y3.^3)+2.*nu.^2.*(x3.*( ...
            x3.^2+(x1-y1).^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.*x3)+( ...
            x1-y1).^2+(x2-y2).^2).*y3-(lr2-3.*x3).*y3.^2+ ...
            y3.^3)+y3.*((x1-y1).^2+(x2-y2).^2-(lr2-x3+( ...
            -1).*y3).*(2.*x3+y3)))+4.*lr2.^(-1).*(x1-y1).^2.*((x1- ...
            y1).^2+(x2-y2).^2).^(-2).*((-3).*nu.*(x3+y3).*((x1-y1) ...
            .^2+(x2-y2).^2+(x3+y3).^2)+2.*nu.^2.*(x3+y3).*((x1-y1) ...
            .^2+(x2-y2).^2+(x3+y3).^2)+y3.*((x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).*(2.*x3+y3)))+lr2.^(-1).*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-1).*(6.*nu.*(x3+y3).*(3.*(x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).^2)-4.*nu.^2.*(x3+y3).*(3.*(x1-y1).^2+(x2+ ...
            (-1).*y2).^2+(x3+y3).^2)-2.*y3.*(3.*(x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).*(2.*x3+y3)))+log(lr2+x3+y3)+xLogy((-1),lr1+x3- ...
            y3)+xLogy(2.*(1-2.*nu).*nu,lr2+x3+y3));
    end


    function d=J1212d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*((1+8.*((-1)+nu).*nu).*lr2.^( ...
            -1).*(x2-y2)+lr1.^(-1).*(-x2+y2)-4.*((-1)+nu).*((-1)+ ...
            2.*nu).*lr2.^(-1).*(x2-y2).*(x3+y3).*(lr2+x3+y3).^(-1)+2.*x3.* ...
            (x2-y2).*y3.*((x1-y1).^2+(x2-y2).^2+(x3+y3).^2) ...
            .^(-3/2)).*G.^(-1);
    end

    function d=J1213d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(-lr1.^(-1).*( ...
            x2-y2).^2.*(lr1+x3-y3).^(-1)-((-1)-2.*nu+4.* ...
            nu.^2).*lr2.^(-1).*(x2-y2).^2.*(lr2+x3+y3).^(-1)+2.*((-1)+nu) ...
            .*((-1)+2.*nu).*((x1-y1).^2+(x2-y2).^2).^(-1).*y3.*( ...
            2.*x3+y3)-4.*((-1)+nu).*((-1)+2.*nu).*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-2).*(x2-y2).^2.*y3.*(2.*x3+y3)+2.*((-1)+nu) ...
            .*((-1)+2.*nu).*lr2.^(-2).*((x1-y1).^2+(x2-y2).^2).^( ...
            -1).*(x2-y2).^2.*y3.*(2.*x3+y3)+2.*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-1).*(x2-y2).^2.*((x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).^2).^(-3/2).*((-3).*nu.*(x3.*(x3.^2+(x1-y1) ...
            .^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1).^2+(x2+( ...
            -1).*y2).^2).*y3-(lr2-3.*x3).*y3.^2+y3.^3)+2.*nu.^2.*(x3.* ...
            (x3.^2+(x1-y1).^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.*x3)+( ...
            x1-y1).^2+(x2-y2).^2).*y3-(lr2-3.*x3).*y3.^2+ ...
            y3.^3)+y3.*((x1-y1).^2+(x2-y2).^2-(lr2-x3+( ...
            -1).*y3).*(2.*x3+y3)))+4.*lr2.^(-1).*((x1-y1).^2+(x2- ...
            y2).^2).^(-2).*(x2-y2).^2.*((-3).*nu.*(x3+y3).*((x1- ...
            y1).^2+(x2-y2).^2+(x3+y3).^2)+2.*nu.^2.*(x3+y3).*((x1- ...
            y1).^2+(x2-y2).^2+(x3+y3).^2)+y3.*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2+(x3+y3).*(2.*x3+y3)))+lr2.^(-1).*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-1).*(6.*nu.*(x3+y3).*((x1-y1).^2+3.*(x2+(-1) ...
            .*y2).^2+(x3+y3).^2)-4.*nu.^2.*(x3+y3).*((x1-y1).^2+3.*( ...
            x2-y2).^2+(x3+y3).^2)-2.*y3.*((x1-y1).^2+3.*(x2+( ...
            -1).*y2).^2+(x3+y3).*(2.*x3+y3)))+log(lr2+x3+y3)+xLogy((-1),lr1+x3+( ...
            -1).*y3)+xLogy(2.*(1-2.*nu).*nu,lr2+x3+y3));
    end


    function d=J1223d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*(-lr1.^(-1).*(x1- ...
            y1).*(x2-y2).*(lr1+x3-y3).^(-1)-((-1)-2.*nu+ ...
            4.*nu.^2).*lr2.^(-1).*(x1-y1).*(x2-y2).*(lr2+x3+y3).^( ...
            -1)-4.*((-1)+nu).*((-1)+2.*nu).*(x1-y1).*((x1-y1) ...
            .^2+(x2-y2).^2).^(-2).*(x2-y2).*y3.*(2.*x3+y3)+2.*(( ...
            -1)+nu).*((-1)+2.*nu).*lr2.^(-2).*(x1-y1).*((x1-y1).^2+ ...
            (x2-y2).^2).^(-1).*(x2-y2).*y3.*(2.*x3+y3)-4.*lr2.^( ...
            -1).*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*( ...
            x2-y2).*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3))+2.*(x1+(-1) ...
            .*y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2).*( ...
            (x1-y1).^2+(x2-y2).^2+(x3+y3).^2).^(-3/2).*((-3).*nu.* ...
            (x3.*(x3.^2+(x1-y1).^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.* ...
            x3)+(x1-y1).^2+(x2-y2).^2).*y3-(lr2-3.*x3).* ...
            y3.^2+y3.^3)+2.*nu.^2.*(x3.*(x3.^2+(x1-y1).^2+(x2-y2) ...
            .^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1).^2+(x2-y2).^2).*y3+ ...
            (-1).*(lr2-3.*x3).*y3.^2+y3.^3)+y3.*((x1-y1).^2+(x2- ...
            y2).^2-(lr2-x3-y3).*(2.*x3+y3)))+4.*lr2.^(-1).*( ...
            x1-y1).*((x1-y1).^2+(x2-y2).^2).^(-2).*(x2+(-1) ...
            .*y2).*((-3).*nu.*(x3+y3).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2)+2.*nu.^2.*(x3+y3).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2)+y3.*((x1-y1).^2+(x2-y2).^2+(x3+y3).*(2.*x3+y3) ...
            ))).*G.^(-1);
    end


    function d=J2212d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(x3.^2.*(x3.^2+(x1+ ...
            (-1).*y1).^2).^(-1)+9.*x3.^2.*(9.*x3.^2+(x1-y1).^2).^(-1)+ ...
            4.*nu.^2.*x3.^2.*(nu.^2.*x3.^2+(x1-y1).^2).^(-1)-((-3) ...
            +4.*nu).*(lr1+x1-y1).^(-1).*(x2-y2)-((-3)+4.*nu) ...
            .*lr1.^(-1).*(x1-y1).*(lr1+x1-y1).^(-1).*(x2-y2)+( ...
            5+4.*nu.*((-3)+2.*nu)).*(lr2+x1-y1).^(-1).*(x2-y2)+(5+ ...
            4.*nu.*((-3)+2.*nu)).*lr2.^(-1).*(x1-y1).*(lr2+x1-y1).^( ...
            -1).*(x2-y2)-4.*((-1)+nu).*lr1.^(-1).*(x1-y1).^2.*( ...
            lr1+x2-y2).^(-1)-4.*((-1)+nu).*lr2.^(-1).*(x1-y1) ...
            .^2.*(lr2+x2-y2).^(-1)+4.*((-1)+nu).*lr1.*(x2-y2).*((x1+ ...
            (-1).*y1).^2+(x3-y3).^2).^(-1).*((x2-y2).^2+(x3- ...
            y3).^2).^(-1).*(x3-y3).^2-4.*((-1)+nu).*lr1.^(-1).*(x1+( ...
            -1).*y1).^2.*(x2-y2).*((x1-y1).^2+(x3-y3).^2).^( ...
            -1).*((x2-y2).^2+(x3-y3).^2).^(-1).*(x3-y3).^2+( ...
            -4).*((-1)+nu).*((-1)+2.*nu).*((x1-y1).^2+(x2-y2).^2) ...
            .^(-1).*(x2-y2).*(x3+y3)+y3.^2.*((x1-y1).^2+y3.^2).^( ...
            -1)+9.*y3.^2.*((x1-y1).^2+9.*y3.^2).^(-1)+4.*nu.^2.*y3.^2.*( ...
            (x1-y1).^2+nu.^2.*y3.^2).^(-1)+2.*lr2.^(-1).*x3.*(x2- ...
            y2).*y3.*((x2-y2).^2+(x3+y3).^2).^(-1)+4.*((-1)+nu).*((-1)+ ...
            2.*nu).*lr2.*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2- ...
            y2).*(x3+y3).^2.*((x2-y2).^2+(x3+y3).^2).^(-1)-4.*((-1)+ ...
            nu).*((-1)+2.*nu).*lr2.^(-1).*(x1-y1).^2.*((x1-y1).^2+( ...
            x2-y2).^2).^(-1).*(x2-y2).*(x3+y3).^2.*((x2-y2) ...
            .^2+(x3+y3).^2).^(-1)+4.*((-1)+nu).*lr2.*(x2-y2).*(x3+y3) ...
            .^2.*((x1-y1).^2+(x3+y3).^2).^(-1).*((x2-y2).^2+(x3+ ...
            y3).^2).^(-1)-4.*((-1)+nu).*lr2.^(-1).*(x1-y1).^2.*(x2+( ...
            -1).*y2).*(x3+y3).^2.*((x1-y1).^2+(x3+y3).^2).^(-1).*((x2+( ...
            -1).*y2).^2+(x3+y3).^2).^(-1)-2.*x3.*(x1-y1).^2.*(x2+(-1) ...
            .*y2).*y3.*((x2-y2).^2+(x3+y3).^2).^(-1).*((x1-y1).^2+ ...
            (x2-y2).^2+(x3+y3).^2).^(-3/2)+xLogy(4-4.*nu,lr1+x2- ...
            y2)+xLogy(4-4.*nu,lr2+x2-y2));
    end


    function d=J2213d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(x2.^2.*(x2.^2+(x1+ ...
            (-1).*y1).^2).^(-1)+9.*x2.^2.*(9.*x2.^2+(x1-y1).^2).^(-1)+ ...
            4.*nu.^2.*x2.^2.*(nu.^2.*x2.^2+(x1-y1).^2).^(-1)+2.*x3.*(lr2+ ...
            (-1).*x1+y1).^(-1)+2.*lr2.^(-1).*x3.*(-x1+y1).*(lr2-x1+ ...
            y1).^(-1)-2.*((-1)+nu).*((-1)+2.*nu).*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-1).*(x2-y2).^2+y2.^2.*((x1-y1).^2+ ...
            y2.^2).^(-1)+9.*y2.^2.*((x1-y1).^2+9.*y2.^2).^(-1)+4.* ...
            nu.^2.*y2.^2.*((x1-y1).^2+nu.^2.*y2.^2).^(-1)-((-3)+ ...
            4.*nu).*(lr1+x1-y1).^(-1).*(x3-y3)-((-3)+4.*nu).* ...
            lr1.^(-1).*(x1-y1).*(lr1+x1-y1).^(-1).*(x3-y3)+2.* ...
            ((-1)+2.*nu).*lr1.*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2+( ...
            -1).*y2).^2.*((x2-y2).^2+(x3-y3).^2).^(-1).*(x3- ...
            y3)-2.*((-1)+2.*nu).*lr1.^(-1).*(x1-y1).^2.*((x1-y1) ...
            .^2+(x2-y2).^2).^(-1).*(x2-y2).^2.*((x2-y2).^2+( ...
            x3-y3).^2).^(-1).*(x3-y3)-((-3)+4.*nu).*lr1.^(-1) ...
            .*(x1-y1).^2.*(lr1+x3-y3).^(-1)-(5+4.*nu.*((-3)+ ...
            2.*nu)).*(lr2+x1-y1).^(-1).*(x3+y3)-(5+4.*nu.*((-3)+2.* ...
            nu)).*lr2.^(-1).*(x1-y1).*(lr2+x1-y1).^(-1).*(x3+y3)+( ...
            -1).*(3-6.*nu+4.*nu.^2).*lr2.^(-1).*(x1-y1).^2.*(lr2+x3+y3) ...
            .^(-1)+4.*((-1)+nu).*((-1)+2.*nu).*(x1-y1).^2.*((x1- ...
            y1).^2+(x2-y2).^2).^(-2).*y3.*(2.*x3+y3)-2.*((-1)+nu).*(( ...
            -1)+2.*nu).*lr2.^(-2).*(x1-y1).^2.*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-1).*y3.*(2.*x3+y3)+2.*((-1)+2.*nu).*((x1-y1) ...
            .^2+(x2-y2).^2).^(-1).*((x2-y2).^2+(x3+y3).^2).^(-1).* ...
            (((-1)+2.*nu).*lr2.*(x2-y2).^2.*(x3+y3)-((-1)+nu).*y3.* ...
            (2.*x3+y3).*((x2-y2).^2+(x3+y3).^2))-4.*lr2.^(-1).*(x1+( ...
            -1).*y1).^2.*((x1-y1).^2+(x2-y2).^2).^(-2).*((x2+(-1) ...
            .*y2).^2+(x3+y3).^2).^(-1).*(x2.^4.*y3+4.*x2.^2.*x3.^2.*y3+2.* ...
            x3.^4.*y3+x2.^2.*y1.^2.*y3+2.*x3.^2.*y1.^2.*y3-4.*x2.^3.*y2.* ...
            y3-8.*x2.*x3.^2.*y2.*y3-2.*x2.*y1.^2.*y2.*y3+6.*x2.^2.* ...
            y2.^2.*y3+4.*x3.^2.*y2.^2.*y3+y1.^2.*y2.^2.*y3-4.*x2.*y2.^3.* ...
            y3+y2.^4.*y3+6.*x2.^2.*x3.*y3.^2+7.*x3.^3.*y3.^2+3.*x3.*y1.^2.* ...
            y3.^2-12.*x2.*x3.*y2.*y3.^2+6.*x3.*y2.^2.*y3.^2+2.*x2.^2.* ...
            y3.^3+9.*x3.^2.*y3.^3+y1.^2.*y3.^3-4.*x2.*y2.*y3.^3+2.*y2.^2.* ...
            y3.^3+5.*x3.*y3.^4+y3.^5-3.*nu.*(x3+y3).*((x2-y2).^2+(x3+ ...
            y3).^2).*((x1-y1).^2+(x2-y2).^2+(x3+y3).^2)+2.*nu.^2.* ...
            (x3+y3).*((x2-y2).^2+(x3+y3).^2).*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2+(x3+y3).^2)+x1.^2.*y3.*((x2-y2).^2+(x3+y3).*(2.*x3+ ...
            y3))-2.*x1.*y1.*y3.*((x2-y2).^2+(x3+y3).*(2.*x3+y3)))+( ...
            -2).*(x1-y1).^2.*((x1-y1).^2+(x2-y2).^2).^(-1).* ...
            ((x2-y2).^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).^2).^(-3/2).*(x2.^4.*y3-2.*lr2.*x2.^2.*x3.*y3+4.* ...
            x2.^2.*x3.^2.*y3-2.*lr2.*x3.^3.*y3+2.*x3.^4.*y3+x2.^2.*y1.^2.* ...
            y3+2.*x3.^2.*y1.^2.*y3-4.*x2.^3.*y2.*y3+4.*lr2.*x2.*x3.*y2.*y3+( ...
            -8).*x2.*x3.^2.*y2.*y3-2.*x2.*y1.^2.*y2.*y3+6.*x2.^2.*y2.^2.* ...
            y3-2.*lr2.*x3.*y2.^2.*y3+4.*x3.^2.*y2.^2.*y3+y1.^2.*y2.^2.*y3+( ...
            -4).*x2.*y2.^3.*y3+y2.^4.*y3-lr2.*x2.^2.*y3.^2+6.*x2.^2.*x3.* ...
            y3.^2-5.*lr2.*x3.^2.*y3.^2+7.*x3.^3.*y3.^2+3.*x3.*y1.^2.*y3.^2+ ...
            2.*lr2.*x2.*y2.*y3.^2-12.*x2.*x3.*y2.*y3.^2-lr2.*y2.^2.* ...
            y3.^2+6.*x3.*y2.^2.*y3.^2+2.*x2.^2.*y3.^3-4.*lr2.*x3.*y3.^3+9.* ...
            x3.^2.*y3.^3+y1.^2.*y3.^3-4.*x2.*y2.*y3.^3+2.*y2.^2.*y3.^3+(-1) ...
            .*lr2.*y3.^4+5.*x3.*y3.^4+y3.^5-3.*nu.*(x3.*(x3.^2+y1.^2+(x2+( ...
            -1).*y2).^2)+((-2).*lr2.*x3+3.*x3.^2+y1.^2+(x2-y2).^2).*y3+( ...
            -1).*(lr2-3.*x3).*y3.^2+y3.^3).*((x2-y2).^2+(x3+y3).^2)+ ...
            2.*nu.^2.*(x3.*(x3.^2+y1.^2+(x2-y2).^2)+((-2).*lr2.*x3+3.* ...
            x3.^2+y1.^2+(x2-y2).^2).*y3-(lr2-3.*x3).*y3.^2+ ...
            y3.^3).*((x2-y2).^2+(x3+y3).^2)+2.*x1.*y1.*(3.*nu.*(x3+y3).* ...
            ((x2-y2).^2+(x3+y3).^2)-2.*nu.^2.*(x3+y3).*((x2-y2) ...
            .^2+(x3+y3).^2)-y3.*((x2-y2).^2+(x3+y3).*(2.*x3+y3)))+ ...
            x1.^2.*((-3).*nu.*(x3+y3).*((x2-y2).^2+(x3+y3).^2)+2.* ...
            nu.^2.*(x3+y3).*((x2-y2).^2+(x3+y3).^2)+y3.*((x2-y2) ...
            .^2+(x3+y3).*(2.*x3+y3))))+2.*lr2.^(-1).*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-1).*((x2-y2).^2+(x3+y3).^2).^(-1).*(-x3.* ...
            y1.^2.*y2.^2+2.*x3.^4.*y3+6.*x3.^2.*y1.^2.*y3+4.*x3.^2.*y2.^2.*y3+ ...
            2.*y1.^2.*y2.^2.*y3+y2.^4.*y3+7.*x3.^3.*y3.^2+9.*x3.*y1.^2.*y3.^2+ ...
            6.*x3.*y2.^2.*y3.^2+9.*x3.^2.*y3.^3+3.*y1.^2.*y3.^3+2.*y2.^2.* ...
            y3.^3+5.*x3.*y3.^4+y3.^5+x2.^4.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*( ...
            x3+y3))-4.*x2.^3.*y2.*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3))+ ...
            2.*x2.*y2.*(x3.*y1.^2-4.*x3.^2.*y3-2.*y1.^2.*y3-2.* ...
            y2.^2.*y3-6.*x3.*y3.^2-2.*y3.^3-2.*nu.^2.*(x3+y3).*( ...
            y1.^2+2.*y2.^2+2.*(x3+y3).^2)+nu.*(x3+y3).*(5.*y1.^2+6.*y2.^2+6.*( ...
            x3+y3).^2))+x2.^2.*(-x3.*y1.^2+4.*x3.^2.*y3+2.*y1.^2.*y3+6.* ...
            y2.^2.*y3+6.*x3.*y3.^2+2.*y3.^3+2.*nu.^2.*(x3+y3).*(y1.^2+6.* ...
            y2.^2+2.*(x3+y3).^2)-nu.*(x3+y3).*(5.*y1.^2+18.*y2.^2+6.*( ...
            x3+y3).^2))+x1.^2.*(-x2.^2.*x3+2.*x2.*x3.*y2-x3.*y2.^2+ ...
            2.*x2.^2.*y3+6.*x3.^2.*y3-4.*x2.*y2.*y3+2.*y2.^2.*y3+9.*x3.* ...
            y3.^2+3.*y3.^3+2.*nu.^2.*(x3+y3).*((x2-y2).^2+3.*(x3+y3).^2) ...
            -nu.*(x3+y3).*(5.*(x2-y2).^2+9.*(x3+y3).^2))+2.*x1.* ...
            y1.*(x2.^2.*x3-2.*x2.*x3.*y2+x3.*y2.^2-2.*x2.^2.*y3-6.* ...
            x3.^2.*y3+4.*x2.*y2.*y3-2.*y2.^2.*y3-9.*x3.*y3.^2-3.* ...
            y3.^3-2.*nu.^2.*(x3+y3).*((x2-y2).^2+3.*(x3+y3).^2)+nu.*( ...
            x3+y3).*(5.*(x2-y2).^2+9.*(x3+y3).^2))-nu.*(x3+y3).*( ...
            3.*x3.^4+12.*x3.^3.*y3+3.*(y2.^2+y3.^2).^2+3.*x3.^2.*(3.*y1.^2+2.* ...
            y2.^2+6.*y3.^2)+y1.^2.*(5.*y2.^2+9.*y3.^2)+6.*x3.*y3.*(3.*y1.^2+ ...
            2.*(y2.^2+y3.^2)))+2.*nu.^2.*(x3+y3).*(x3.^4+4.*x3.^3.*y3+(y2.^2+ ...
            y3.^2).^2+y1.^2.*(y2.^2+3.*y3.^2)+x3.^2.*(3.*y1.^2+2.*y2.^2+6.* ...
            y3.^2)+x3.*(6.*y1.^2.*y3+4.*y3.*(y2.^2+y3.^2))))+xLogy(3-4.*nu, ...
            lr1+x3-y3)+xLogy((-3)+6.*nu-4.*nu.^2,lr2+x3+y3));
    end



    function d=J2223d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(x1.*(x1.^2+(x2+( ...
            -1).*y2).^2).^(-1).*(-x2+y2)+9.*x1.*(9.*x1.^2+(x2-y2) ...
            .^2).^(-1).*(-x2+y2)+4.*nu.^2.*x1.*(nu.^2.*x1.^2+(x2- ...
            y2).^2).^(-1).*(-x2+y2)-4.*((-1)+nu).*lr1.^(-1).*(x1- ...
            y1).*(lr1+x2-y2).^(-1).*(x3-y3)-4.*((-1)+nu).*lr1.*( ...
            x1-y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2+(-1) ...
            .*y2).*((x1-y1).^2+(x3-y3).^2).^(-1).*(x3-y3)+( ...
            -4).*((-1)+nu).*lr1.^(-1).*(x1-y1).^3.*((x1-y1).^2+(x2+ ...
            (-1).*y2).^2).^(-1).*(x2-y2).*((x1-y1).^2+(x3- ...
            y3).^2).^(-1).*(x3-y3)-((-3)+4.*nu).*lr1.^(-1).*(x1+( ...
            -1).*y1).*(x2-y2).*(lr1+x3-y3).^(-1)+4.*((-1)+nu).* ...
            lr2.^(-1).*(x1-y1).*(lr2+x2-y2).^(-1).*(x3+y3)-(3+ ...
            (-6).*nu+4.*nu.^2).*lr2.^(-1).*(x1-y1).*(x2-y2).*(lr2+ ...
            x3+y3).^(-1)-4.*((-1)+nu).*((-1)+2.*nu).*(x1-y1).*((x1+( ...
            -1).*y1).^2+(x2-y2).^2).^(-2).*(x2-y2).*y3.*(2.*x3+y3) ...
            +2.*((-1)+nu).*((-1)+2.*nu).*lr2.^(-2).*(x1-y1).*((x1- ...
            y1).^2+(x2-y2).^2).^(-1).*(x2-y2).*y3.*(2.*x3+y3) ...
            -4.*lr2.^(-1).*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^( ...
            -1).*(x2-y2).*(y3-3.*nu.*(x3+y3)+2.*nu.^2.*(x3+y3))+4.*(( ...
            -1)+nu).*lr2.*(x1-y1).*((x1-y1).^2+(x2-y2).^2).^( ...
            -1).*(x2-y2).*(x3+y3).*((x1-y1).^2+(x3+y3).^2).^(-1)+ ...
            4.*((-1)+nu).*lr2.^(-1).*(x1-y1).^3.*((x1-y1).^2+(x2+( ...
            -1).*y2).^2).^(-1).*(x2-y2).*(x3+y3).*((x1-y1).^2+(x3+ ...
            y3).^2).^(-1)+2.*(x1-y1).*((x1-y1).^2+(x2-y2) ...
            .^2).^(-1).*(x2-y2).*((x1-y1).^2+(x2-y2).^2+(x3+ ...
            y3).^2).^(-3/2).*((-3).*nu.*(x3.*(x3.^2+(x1-y1).^2+(x2+(-1) ...
            .*y2).^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1).^2+(x2-y2).^2) ...
            .*y3-(lr2-3.*x3).*y3.^2+y3.^3)+2.*nu.^2.*(x3.*(x3.^2+(x1+( ...
            -1).*y1).^2+(x2-y2).^2)+(x3.*((-2).*lr2+3.*x3)+(x1-y1) ...
            .^2+(x2-y2).^2).*y3-(lr2-3.*x3).*y3.^2+y3.^3)+y3.*(( ...
            x1-y1).^2+(x2-y2).^2-(lr2-x3-y3).*( ...
            2.*x3+y3)))+4.*lr2.^(-1).*(x1-y1).*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-2).*(x2-y2).*((-3).*nu.*(x3+y3).*((x1-y1) ...
            .^2+(x2-y2).^2+(x3+y3).^2)+2.*nu.^2.*(x3+y3).*((x1-y1) ...
            .^2+(x2-y2).^2+(x3+y3).^2)+y3.*((x1-y1).^2+(x2- ...
            y2).^2+(x3+y3).*(2.*x3+y3)))+atan2(x2-y2,(-1).*x1)-3.* ...
            atan2(3.*x1,x2-y2)+4.*nu.*atan2(-nu.*x1,x2-y2)+( ...
            4-4.*nu).*atan2(lr1.*(x1-y1),(x2-y2).*(x3-y3)) ...
            +4.*((-1)+nu).*atan2(lr2.*(x1-y1),(x2-y2).*(x3+y3)));
    end



    function d=J1312d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(-1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(4.*((-1)+nu).*(( ...
            -1)+2.*nu).*(x1-y1).^2.*((x1-y1).^2+(x2-y2).^2) ...
            .^(-1)+(lr1+x2-y2).^(-1).*(x3-y3)+lr1.^(-1).*(x2- ...
            y2).*(lr1+x2-y2).^(-1).*(x3-y3)+4.*((-1)+nu).*((-1)+2.* ...
            nu).*lr2.^(-1).*(x2-y2).^2.*(lr2+x3+y3).^(-1)+(lr2+x2-y2) ...
            .^(-1).*((7+8.*((-2)+nu).*nu).*x3+y3+8.*((-1)+nu).*nu.*y3)+lr2.^( ...
            -1).*(x2-y2).*(lr2+x2-y2).^(-1).*((7+8.*((-2)+nu).*nu) ...
            .*x3+y3+8.*((-1)+nu).*nu.*y3)-4.*((-1)+nu).*((-1)+2.*nu).*lr2.*( ...
            x1-y1).^2.*((x1-y1).^2+(x2-y2).^2).^(-1).*(x3+ ...
            y3).*((x1-y1).^2+(x3+y3).^2).^(-1)+4.*((-1)+nu).*((-1)+2.* ...
            nu).*lr2.^(-1).*(x1-y1).^2.*((x1-y1).^2+(x2-y2) ...
            .^2).^(-1).*(x2-y2).^2.*(x3+y3).*((x1-y1).^2+(x3+y3) ...
            .^2).^(-1)+2.*lr2.^(-1).*x3.*y3.*(x3+y3).*((x1-y1).^2+(x3+y3) ...
            .^2).^(-1)-2.*x3.*(x2-y2).^2.*y3.*(x3+y3).*((x1-y1) ...
            .^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2-y2).^2+(x3+y3) ...
            .^2).^(-3/2)+xLogy(4.*((-1)+nu).*((-1)+2.*nu),lr2+x3+y3));
    end


    function d=J1313d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(-1/16).*(1-nu).^(-1).*pi.^(-1).*(lr1.^(-1).*(x2-y2)+2.* ...
            (7+8.*((-2)+nu).*nu).*lr2.^(-1).*(x2-y2)-2.*lr2.^(-1).*(x2+ ...
            (-1).*y2).*(lr2+x3+y3).^(-1).*(3.*x3+2.*y3-6.*nu.*(x3+y3)+4.* ...
            nu.^2.*(x3+y3))-2.*((-3)+4.*nu).*x3.*((x1-y1).^2+(x2+(-1) ...
            .*y2).^2).^(-1).*(x2-y2).*(x3+y3).*((x1-y1).^2+(x2+( ...
            -1).*y2).^2+(x3+y3).^2).^(-1/2)+(x2-y2).*((x1-y1).^2+( ...
            x2-y2).^2+(x3+y3).^2).^(-3/2).*(((-7)-8.*((-2)+nu).*nu).* ...
            x1.^2+2.*(7+8.*((-2)+nu).*nu).*x1.*y1+((-7)-8.*((-2)+nu).*nu).* ...
            y1.^2-7.*(x3.^2+(x2-y2).^2)-16.*x3.*y3-7.*y3.^2+( ...
            -8).*((-2)+nu).*nu.*((x2-y2).^2+(x3+y3).^2))).*G.^(-1);
    end


    function d=J1323d2(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(-1/16).*(1-nu).^(-1).*pi.^(-1).*((x1-y1).*(lr1+x2+(-1) ...
            .*y2).^(-1)+lr1.^(-1).*(x1-y1).*(x2-y2).*(lr1+x2- ...
            y2).^(-1)+(7+8.*((-2)+nu).*nu).*(x1-y1).*(lr2+x2-y2).^( ...
            -1)+(7+8.*((-2)+nu).*nu).*lr2.^(-1).*(x1-y1).*(x2-y2).* ...
            (lr2+x2-y2).^(-1)-4.*((-1)+nu).*((-1)+2.*nu).*(x1- ...
            y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x3+y3)+2.*lr2.^( ...
            -1).*x3.*(-x1+y1).*y3.*((x1-y1).^2+(x3+y3).^2).^(-1)+ ...
            4.*((-1)+nu).*lr2.*(x1-y1).*((x1-y1).^2+(x2-y2) ...
            .^2).^(-1).*(x3+y3).*((-3).*x3-y3+2.*nu.*(x3+y3)).*((x1+(-1) ...
            .*y1).^2+(x3+y3).^2).^(-1)-4.*((-1)+nu).*lr2.^(-1).*(x1- ...
            y1).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2).^2.* ...
            (x3+y3).*((-3).*x3-y3+2.*nu.*(x3+y3)).*((x1-y1).^2+( ...
            x3+y3).^2).^(-1)+2.*x3.*(x1-y1).*(x2-y2).^2.*y3.*((x1+ ...
            (-1).*y1).^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2-y2) ...
            .^2+(x3+y3).^2).^(-3/2)).*G.^(-1);
    end


    function d=J2312d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(-1/16).*(1-nu).^(-1).*pi.^(-1).*G.^(-1).*(4.*((-1)+nu).*(( ...
            -1)+2.*nu).*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2- ...
            y2).^2+(lr1+x1-y1).^(-1).*(x3-y3)+lr1.^(-1).*(x1- ...
            y1).*(lr1+x1-y1).^(-1).*(x3-y3)+4.*((-1)+nu).*((-1)+2.* ...
            nu).*lr2.^(-1).*(x1-y1).^2.*(lr2+x3+y3).^(-1)+(lr2+x1-y1) ...
            .^(-1).*((7+8.*((-2)+nu).*nu).*x3+y3+8.*((-1)+nu).*nu.*y3)+lr2.^( ...
            -1).*(x1-y1).*(lr2+x1-y1).^(-1).*((7+8.*((-2)+nu).*nu) ...
            .*x3+y3+8.*((-1)+nu).*nu.*y3)-4.*((-1)+nu).*((-1)+2.*nu).*lr2.*( ...
            (x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2).^2.*(x3+ ...
            y3).*((x2-y2).^2+(x3+y3).^2).^(-1)+4.*((-1)+nu).*((-1)+2.* ...
            nu).*lr2.^(-1).*(x1-y1).^2.*((x1-y1).^2+(x2-y2) ...
            .^2).^(-1).*(x2-y2).^2.*(x3+y3).*((x2-y2).^2+(x3+y3) ...
            .^2).^(-1)+2.*lr2.^(-1).*x3.*y3.*(x3+y3).*((x2-y2).^2+(x3+y3) ...
            .^2).^(-1)-2.*x3.*(x1-y1).^2.*y3.*(x3+y3).*((x2-y2) ...
            .^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2-y2).^2+(x3+y3) ...
            .^2).^(-3/2)+xLogy(4.*((-1)+nu).*((-1)+2.*nu),lr2+x3+y3));
    end


    function d=J2313d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(-1/16).*(1-nu).^(-1).*pi.^(-1).*((lr1+x1-y1).^(-1).*( ...
            x2-y2)+lr1.^(-1).*(x1-y1).*(lr1+x1-y1).^(-1).*(x2+ ...
            (-1).*y2)+(7+8.*((-2)+nu).*nu).*(lr2+x1-y1).^(-1).*(x2- ...
            y2)+(7+8.*((-2)+nu).*nu).*lr2.^(-1).*(x1-y1).*(lr2+x1- ...
            y1).^(-1).*(x2-y2)-4.*((-1)+nu).*((-1)+2.*nu).*((x1+(-1) ...
            .*y1).^2+(x2-y2).^2).^(-1).*(x2-y2).*(x3+y3)+2.*lr2.^( ...
            -1).*x3.*(-x2+y2).*y3.*((x2-y2).^2+(x3+y3).^2).^(-1)+ ...
            4.*((-1)+nu).*lr2.*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2+( ...
            -1).*y2).*(x3+y3).*((-3).*x3-y3+2.*nu.*(x3+y3)).*((x2- ...
            y2).^2+(x3+y3).^2).^(-1)-4.*((-1)+nu).*lr2.^(-1).*(x1-y1) ...
            .^2.*((x1-y1).^2+(x2-y2).^2).^(-1).*(x2-y2).*( ...
            x3+y3).*((-3).*x3-y3+2.*nu.*(x3+y3)).*((x2-y2).^2+(x3+ ...
            y3).^2).^(-1)+2.*x3.*(x1-y1).^2.*(x2-y2).*y3.*((x2+( ...
            -1).*y2).^2+(x3+y3).^2).^(-1).*((x1-y1).^2+(x2-y2).^2+ ...
            (x3+y3).^2).^(-3/2)).*G.^(-1);
    end


    function d=J2323d1(y1,y2,y3)
        lr1=r1(y1,y2,y3);
        lr2=r2(y1,y2,y3);
        d=(-1/16).*(1-nu).^(-1).*pi.^(-1).*(lr1.^(-1).*(x1-y1)+2.* ...
            (7+8.*((-2)+nu).*nu).*lr2.^(-1).*(x1-y1)-2.*lr2.^(-1).*(x1+ ...
            (-1).*y1).*(lr2+x3+y3).^(-1).*(3.*x3+2.*y3-6.*nu.*(x3+y3)+4.* ...
            nu.^2.*(x3+y3))-2.*((-3)+4.*nu).*x3.*(x1-y1).*((x1- ...
            y1).^2+(x2-y2).^2).^(-1).*(x3+y3).*((x1-y1).^2+(x2+( ...
            -1).*y2).^2+(x3+y3).^2).^(-1/2)+(x1-y1).*((x1-y1).^2+( ...
            x2-y2).^2+(x3+y3).^2).^(-3/2).*(((-7)-8.*((-2)+nu).*nu).* ...
            x1.^2+2.*(7+8.*((-2)+nu).*nu).*x1.*y1+((-7)-8.*((-2)+nu).*nu).* ...
            y1.^2-7.*(x3.^2+(x2-y2).^2)-16.*x3.*y3-7.*y3.^2+( ...
            -8).*((-2)+nu).*nu.*((x2-y2).^2+(x3+y3).^2))).*G.^(-1);
    end

end
